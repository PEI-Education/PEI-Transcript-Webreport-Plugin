    <args>
      <arg name="curschoolid" type="primitive" required="true" column="ps_schoolenrollment.schoolid" description="School named on transcript" />
    </args>

      <column column="ps_schoolenrollment.schoolid">ps_schoolid</column>
      <column column="schools.name">school_name</column>
      <column column="schools.schooladdress">school_address</column>
      <column column="schools.schoolcity">school_city</column>
      <column column="schools.schoolstate">school_state</column>
      <column column="schools.schoolzip">school_zip</column>
      <column column="schools.schoolphone">school_phone</column>
      <column column="u_def_ext_schools.schoolurl">school_url</column>
      <column column="studentcorefields.pscore_legal_last_name">legal_last_name</column>
      <column column="studentcorefields.pscore_legal_first_name">legal_first_name</column>
      <column column="studentcorefields.pscore_legal_middle_name">legal_middle_name</column>
      <column column="gen.name">esap</column>
      <column column="codeset.displayvalue">esap_selection</column>
      <column column="u_def_ext_students.pei_adpcertificate">adp</column>
      <column column="u_def_ext_students.pei_frenchcertificate">frenchcertificate</column>
      <column column="u_def_ext_students.pei_graduationdate">grad_date</column>
      <column column="u_def_ext_students.pei_hasgraduated">grad_y</column> 
      <column column="u_def_ext_students.pei_hasgraduated">grad_n</column>



              se.SCHOOLID as PS_SCHOOLID,
 sch.name as SCHOOL_NAME,
        sch.schooladdress as SCHOOL_ADDRESS,
        sch.schoolcity as SCHOOL_CITY,
        sch.schoolstate as SCHOOL_STATE,
        sch.schoolzip as SCHOOL_ZIP,
        sch.schoolphone as SCHOOL_PHONE,
        schext.schoolurl schURL,
        scf.pscore_legal_last_name legalLastName,
        scf.pscore_legal_first_name legalFirstName,
        scf.pscore_legal_middle_name legalMiddleName,
        (select distinct
             case when gen.name = 'Essential Skills Achievement Pathway' then 1 else null end
           from SPEnrollments esap
           join GEN
             on GEN.id = esap.programid
           where
           gen.name = 'Essential Skills Achievement Pathway'
             and esap.studentid = s.id
             and (esap.exit_date >= SYSDATE OR esap.exitcode = 'GRAD')
         ) as esap,
         nvl(code.displayvalue, 'None') esapSelection,
         nvl(stuext.pei_adpcertificate,0) adp,
         nvl(stuext.pei_frenchcertificate,0) frenchcertificate,
         stuext.pei_graduationdate gradDate,
         case when substr(stuext.pei_hasgraduated, 0,1) = 'Y' then 1 else null end as gradY,
         case when substr(stuext.pei_hasgraduated, 0,1) <> 'Y' or stuext.pei_graduationdate is null then 1 else null end as gradN,





          <access_request>
    <field table="STUDENTS" field="DCID" access="ViewOnly"/>
    <field table="STUDENTS" field="ID" access="ViewOnly"/>
    <field table="STUDENTS" field="FIRST_NAME" access="ViewOnly"/>
    <field table="STUDENTS" field="MIDDLE_NAME" access="ViewOnly"/>
    <field table="STUDENTS" field="LAST_NAME" access="ViewOnly"/>
    <field table="STUDENTS" field="DOB" access="ViewOnly"/>
    <field table="STUDENTS" field="STUDENT_NUMBER" access="ViewOnly"/>
    <field table="STUDENTS" field="HOME_ROOM" access="ViewOnly"/>
    <field table="PS_SCHOOLENROLLMENT" field="SCHOOLID" access="ViewOnly"/>
    <field table="SCHOOLS" field="NAME" access="ViewOnly"/>
    <field table="SCHOOLS" field="SCHOOLADDRESS" access="ViewOnly"/>
    <field table="SCHOOLS" field="SCHOOLCITY" access="ViewOnly"/>
    <field table="SCHOOLS" field="SCHOOLSTATE" access="ViewOnly"/>
    <field table="SCHOOLS" field="SCHOOLZIP" access="ViewOnly"/>
    <field table="SCHOOLS" field="SCHOOLPHONE" access="ViewOnly"/>
    <field table="U_DEF_EXT_SCHOOLS" field="SCHOOLURL" access="ViewOnly"/>
    <field table="U_DEF_EXT_STUDENTS" field="PEI_HASGRADUATED" access="ViewOnly"/>
    <field table="U_DEF_EXT_STUDENTS" field="PEI_GRADUATIONDATE" access="ViewOnly"/>
    <field table="U_DEF_EXT_STUDENTS" field="PEI_ADPCERTIFICATE" access="ViewOnly"/>
    <field table="U_DEF_EXT_STUDENTS" field="PEI_FRENCHCERTIFICATE" access="ViewOnly"/>
    <field table="U_DEF_EXT_STUDENTS" field="PEI_IB" access="ViewOnly"/>
    <field table="gen" field="NAME" access="ViewOnly"/>
    <field table="CODESET" field="DISPLAYVALUE" access="ViewOnly"/>
    <field table="terms" field="LASTDAY" access="ViewOnly"/>
    <field table="storedgrades" field="CREDIT_TYPE" access="ViewOnly"/>
    <field table="storedgrades" field="COURSE_NUMBER" access="ViewOnly"/>
    <field table="storedgrades" field="COURSE_NAME" access="ViewOnly"/>
    <field table="storedgrades" field="EARNEDCRHRS" access="ViewOnly"/>
    <field table="storedgrades" field="POTENTIALCRHRS" access="ViewOnly"/>
    <field table="storedgrades" field="GRADE" access="ViewOnly"/>
    <field table="CC" field="COURSE_NUMBER" access="ViewOnly"/>
    <field table="COURSES" field="COURSE_NAME" access="ViewOnly"/>
    <field table="TERMS" field="ABBREVIATION" access="ViewOnly"/>
    <field table="TERMS" field="YEARID" access="ViewOnly"/>
    <field table="STOREDGRADES" field="GRADE" access="ViewOnly"/>
  </access_request>